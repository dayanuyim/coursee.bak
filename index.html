<html>

<head>
  <meta charset="utf-8">
  <link rel="icon" href="favicon.png" />
  <link rel="stylesheet" type="text/css" href="main.css" />
  <script type="text/javascript" src="main.js"></script>
  <title>郡大西巒</title>
</head>

<body>

<h1 class="course-name">郡大西巒<datetime>YYYY.MM.DD</datetime></h1>


<!-- TODO: auto to generate the list-->
<nav>
  <ul>
    <li><a href="#todo">Todo</a></li>
    <li><a href="#weather">天氣</a></li>
    <li><a href="#map">地圖</a></li>
    <li><a href="#doc">文件</a></li>
    <li><a href="#trk-plan">預計行程</a></li>
    <li><a href="#trk-facto">實際行程</a></li>
    <li><a href="#trk-rec">行程記錄</a></li>
    <li><a href="#epilogue">後記</a>
      <ul>
        <li><a href="#supply">資源銷耗</a></li>
        <li><a href="#caretaker">留守記錄</a></li>
      </ul>
    </li>
    <li><a href="#info">行程資訊</a></li>
    <li><a href="#transport">交通</a></li>
    <li><a href="#lodge">住宿</a></li>
    <li><a href="#ref">行程參考</a></li>
  </ul>
  <button onclick="toggleAllSec()">Toggle</button>
</nav>

<section id="todo">
  <button class="sec-toggle" onclick="toggleSec(this)"></button>
  <h2>TODO</h2>
  <div class="sec-content">
    <ul>
      <li>MM/DD(W)
        <ul>
          <li><input type="checkbox">留守</input></li>
          <li><input type="checkbox">保險</input></li>
          <li><input type="checkbox">確認路況</input></li>
          <li><input type="checkbox">充電(電池/營燈)</input></li>
        </ul>
      </li>
      <li>MM/DD(W)
        <ul>
          <li><input type="checkbox">糧食/炊具</input></li>
          <li><input type="checkbox">火車票</input></li>
          <li><input type="checkbox">打包完成(手電筒/營燈/拖鞋/盥洗用品)</input></li>
        </ul>
      </li>
      <li>MM/DD(W)
        <ul>
          <li><input type="checkbox">剪指甲</input></li>
        </ul>
      </li>
    </ul>
  </div>
</section>

<section id="weather">
  <button class="sec-toggle" onclick="toggleSec(this)"></button>
  <h2>天氣預報</h2>
  <div class="sec-content">
    <div>日出日落 <a href="https://sunrise.maplogs.com/zh-TW/taiwan.777.html" target="_blank">0625~1754</a></div>
    <div class="join">中央氣象局
      <a href="http://www.cwb.gov.tw/V7/forecast/entertainment/tribes/014_1001327A04.htm">佳暮</a>
      <a href="http://www.cwb.gov.tw/m/f/entertainment/E040.php">知本</a>
    </div>
  </div>
</section>

<section id="doc">
  <button class="sec-toggle" onclick="toggleSec(this)"></button>
  <h2>文件</h2>
  <div class="sec-content">
    入山證(含名冊、計畫書、路線圖)
  </div>
</section>

<section id="map">
  <button class="sec-toggle" onclick="toggleSec(this)"></button>
  <h2>地圖</h2>
  <div class="sec-content">
    <p><a href="https://www.dropbox.com/s/0m7ha4hrnhcnnez/ref.gpx?dl=1">參考航跡</a></p>
    <p><a href="https://www.dropbox.com/s/7zchjcrpuoxcis0/overview.jpg?dl=1">Overview</a></p>
    <p class="join">魯地圖
      <a href="https://www.dropbox.com/s/xzuz2yz4igvfwj1/d1.png?dl=1">d1</a>
      <a href="https://www.dropbox.com/s/6bhxlayppi4lqpn/d2.png?dl=1">d2</a>
      <a href="https://www.dropbox.com/s/q1t328v0u3hr44z/d3.png?dl=1">d3</a>
    </p>
    <button onclick="loadMap()">線上地圖</button>
    <object class="hide" id="mapobj" type="text/html" data="" width="100%" height="600">
      <!--<embed src="https://dayanuyim.github.io/maps/" width="800" height="600" ></embed>-->
      不支援ifram, 請連至<a href="https://dayanuyim.github.io/maps/">Trekkr</a>
    </object>
  </div>
</section>

<script>
  function loadMap(){
    const obj = document.getElementById('mapobj');
    obj.classList.toggle('hide');
    obj.setAttribute('data', "https://dayanuyim.github.io/maps/");
  }
</script>

<section id="trk-plan">
  <button class="sec-toggle" onclick="toggleSec(this)"></button>
  <h2>預計行程</h2>
  <div class="sec-content">
    <div class="trk-paths">
      <!--
      <div class="trk-path">
        <a title="LOCATION" href="LINK">🌤</a>
        <span class="tag">D01</span>
        <span class="path">
          <span>PLACE</span>
          <span><time>HHMM</time>PLACE<span class="alt">NNN</span></span>
        </span>
      </div>
      -->
      <div class="trk-path">
        <a title="瑞穗" href="https://www.cwb.gov.tw/V8/C/L/Tribes/012/Map_Tribes_1001509.html">🌤</a>
        <span class="tag">D00</span>
        <span class="path">
          <span>台北</span>
          <span>瑞穗</span>
        </span>
      </div>
      <div class="trk-path">
        <a title="光復" href="https://www.cwb.gov.tw/V8/C/L/Tribes/012/Map_Tribes_1001507.html">🌤</a>
        <span class="tag">D01</span>
        <span class="path">
          <span><time></time>瑞穗<span class="alt"></span></span>
          <span><time>0600</time>大富</span>
          <span><time>0630</time>大富產道口<span class="alt">200</span></span>
          <span><time>0800</time>柵門<span class="alt">680</span></span>
          <span><time>0900</time>虎狼山稜<span class="alt">850</span></span>
          <span><time>1030~1100</time>上稜(午餐)<span class="alt">1150</span></span>
          <span><time>1330</time>拔仔山北鞍<span class="alt">1720</span></span>
          <span><time>1430</time>關門古道休息站(水)</span>
          <span><time>1600</time>4T平地<span class="alt"></span></span>
        </span>
      </div>
      <div class="trk-path">
        <a title="萬榮" href="https://www.cwb.gov.tw/V8/C/L/Tribes/009/Map_Tribes_1001512.html">🌤</a>
        <span class="tag">D01</span>
        <span class="path">
          <span>C01</span>
          <span><time></time>北繞興魯郡山<span class="alt"></span></span>
          <span><time></time>北繞馬侯宛山<span class="alt"></span></span>
          <span><time>1300</time>倫太文前鞍(水)<span class="alt"></span></span>
          <span><time>1430</time>倫太文山<span class="alt"></span></span>
          <span><time>1600</time>三叉路(水?)<span class="alt"></span></span>
        </span>
      </div>
    </div>

    <div>
      <h3>注意事項</h3>
      <div><span class="tag">D2/齊力斷金崩壁</span>高繞，叉路明顯 (參考roachy，上山頭小鞍後腰繞左稜)</div>
      <div><span class="tag">D3/沙溪林道後崩壁</span>高繞後腰繞</div>
      <div><span class="tag">D4/雨谷亭前50米崩壁大崩</span>不好過，可考慮直接上稜高繞，再選擇沿稜或由乾溝下雨谷亭。(參考roachy)</div>
    </div>

    <div>
      <h3>入山證</h3>
    </div>

  </div>
</section>

<section id="trk-facto">
  <button class="sec-toggle" onclick="toggleSec(this)"></button>
  <h2>實際行程</h2>
  <div class="sec-content">
  </div>
</section>

<section id="trk-rec">
  <button class="sec-toggle" onclick="toggleSec(this)"></button>
  <h2>行程記錄</h2>
  <div class="sec-content">
  </div>
</section>

<section id="epilogue">
  <button class="sec-toggle" onclick="toggleSec(this)"></button>
  <h2>後記</h2>
  <div class="sec-content">

    <div id="supply">
      <h2>資源銷耗</h2>
      <div>
        <div><span class="tag">GPS電池</span>NN顆</div>
        <div><span class="tag">瓦斯</span>570g ~= 2.5罐</div>
        <div><span class="tag">衛生紙</span>&lt;半包</div>
      </div>
    </div>

    <div id="caretaker">
      <h2>留守紀錄</h2>
    </div>

  </div>
</section>

<section id="info">
  <button class="sec-toggle" onclick="toggleSec(this)"></button>
  <h2>行程資訊</h2>
  <div class="sec-content">
    <div>
      <h3>營地|水源</h3>
      <span class="tag">O | X</span>松針營地 無水源
    </div>
    <div>
      <h3>訊號</h3>
      (2019/11 中華電信4G)
      起登位於東部時，手機訊號較少且弱；但越往西走，受惠於玉山北峰基地台的建置，南三段手機訊號滿多的；整理如下：
      <ul>
        <li><span class="tag">瑞穗林道33.9K</span>可通(微弱)</li>
        <li><span class="tag">沙武巒越稜點附近</span>可通(微弱)</li>
        <li><span class="tag">盧利拉駱山三角點及往前約0.1K處</span>可通(微弱)</li>
        <li><span class="tag">丹大山三角點</span>陰天及晴天測試約半小時(均無訊號)</li>
      </ul>
    </div>
    <div>
      <h3>徹退路線</h3>
    </div>
  </div>
</section>

<section id="transport">
  <button class="sec-toggle" onclick="toggleSec(this)"></button>
  <h2>交通</h2>
  <div class="sec-content">
    <div>
      <h3>去程</h3>
      <div><span class="tag tag-vehicle">高鐵0157</span>1931起點-2020經過-2105終點 $700</div>
      <div><span class="tag tag-vehicle">區間3217</span>2118起點-2156終點 $47</div>
    </div>
    <div>
      <h3>回程</h3>
      <p><a href="http://www.gbus.com.tw/sys/modules/tinyd2/index.php?id=8"><span class="tag tag-vehicle">豐榮6288(水里-雙龍)</span></a>
        <span>地利-苗圃 $27, 20min</span><br>
        <span>雙龍[發] 0640 0800 1030 <b>1230</b> <b>1500</b> <b>1720</b></span>
      </p>
      <p>
        <a href="http://www.ylbus.com.tw/6732-6734-road.html"><span class="tag tag-vehicle">台灣好行6732(東埔-水里)</span></a>
        <a href="http://www.ylbus.com.tw/6732-6734-road.html"><span class="tag tag-vehicle">台灣好行6734(東埔-集集)</span></a>
        <span>苗圃-東埔 $118, 50min</span><br>
        <span>豐丘-東埔 30min</span><br>
        <span>6732水里[發] 0600 0800 0900 <b>1300</b> <u>1430</u> <b>1740</b> <u>2000</u> (<u>周五停駛</u>)</span><br>
        <span>6734水里[發] 1110 <b>1610</b></span>
      </p>
    </div>
    <canvas id="trans-route" width="400" height="400" style="border:1px solid transparent"></canvas>

    <svg height="400" width="400">
      <circle cx="50" cy="50" r="3" stroke="black" stroke-width="1" fill="green" />
      <text x="50" y="50" fill="black" dominant-baseline="ideographic" text-anchor="middle" >水里</text>

      <line x1="50" y1="50" x2="50" y2="100" style="stroke:rgb(0,0,0);stroke-width:2" />
      <text x="50" y="75" dx="-2" font-size="smaller" fill="blue" text-anchor="end">10min</text>

      <circle cx="50" cy="100" r="3" stroke="black" stroke-width="1" fill="green" />
      <text x="50" y="100" fill="black">苗圃</text>

      <line x1="50" y1="100" x2="50" y2="125" style="stroke:rgb(0,0,0);stroke-width:2" />
      <text x="50" y="112" dx="-2" font-size="smaller" fill="blue" text-anchor="end">5min</text>

      <circle cx="50" cy="125" r="3" stroke="black" stroke-width="1" fill="green" />
      <text x="50" y="125" fill="black" text-anchor="end" dominant-baseline="hanging">新山</text>

      <line x1="50" y1="100" x2="50" y2="200" style="stroke:rgb(0,0,0);stroke-width:2" />
      <text x="50" y="162" dx="-2" font-size="smaller" fill="blue" text-anchor="end">15min</text>

      <circle cx="50" cy="200" r="3" stroke="black" stroke-width="1" fill="green" />
      <text x="50" y="200" fill="black" text-anchor="end" dominant-baseline="middle">豐丘</text>

      <line x1="50" y1="200" x2="50" y2="350" style="stroke:rgb(0,0,0);stroke-width:2" />
      <text x="50" y="275" dx="-2" font-size="smaller" fill="blue" text-anchor="end">30min</text>

      <circle cx="50" cy="350" r="3" stroke="black" stroke-width="1" fill="green" />
      <text x="50" y="350" fill="black" text-anchor="middle" dominant-baseline="hanging">東埔</text>
    </svg>
  </div>
</section>

<script>
  function drawLin(ctx, x, y, dx, dy, text, dash, color){
    const margin = 2;
    const size = 8;
    color = color || 'black';

    ctx.setLineDash(dash? [3,3]: []);
    ctx.moveTo(x, y);
    ctx.lineTo(x+dx, y+dy);
    ctx.strokeStyle = color;
    ctx.stroke();

    //draw line lengend ============
    var tx = x+(dx/2)
    var ty = y+(dy/2)
    if(dx && Math.abs(dy/dx) < 1)  //horizon line?
      ty += size + margin;  //align top
    else
      tx -= margin;

    ctx.font = `italic ${size}pt Calibri`;
    ctx.textAlign = 'end';
    ctx.fillStyle = 'blue'
    ctx.fillText(text, tx, ty);

    return [x+dx, y+dy];
  }

  //pos:
  // 0  1  2
  // 3 (4) 5
  // 6  7  8
  function drawLoc(ctx, x, y, text, pos){
    const orig_x = x, orig_y = y;
    const margin = 4;
    const size = 12;

    ctx.beginPath();
    ctx.arc(x, y, 3, 0, 2*Math.PI);
    ctx.fillStyle = 'black'
    ctx.fill();
    ctx.stroke()

    const align = (pos%3 == 0)? 'end':
                  (pos%3 == 1)? 'center': 'start';
    x += (pos%3 -1) * margin;
    y += Math.floor(pos/3) * size/2;
    y += (Math.floor(pos/3)-1) * margin;

    ctx.font = `italic ${size}pt Calibri`;
    ctx.textAlign = align;
    ctx.fillText(text, x, y);
    return [orig_x, orig_y];
  }

  const ctx = document.getElementById('trans-route').getContext('2d');
  const x0 = 50, y0 = 50;
  [x, y]   = drawLoc(ctx, x0, x0,'水里', 1);
  [x, y]   = drawLin(ctx, x, y, 0, 50, '10m');
  [mx, my] = drawLoc(ctx, x, y, '苗圃', 2);
  [x, y]   = drawLin(ctx, x, y, 0, 25, '5m');
  [nx, ny] = drawLoc(ctx, x, y, '新山', 3);
  [x, y]   = drawLin(ctx, x, y, 0, 75, '15m');
  [fx, fy] = drawLoc(ctx, x, y, '豐丘', 3);
  [x, y]   = drawLin(ctx, x, y, 0, 150, '30m');
  [ex, ey] = drawLoc(ctx, x, y, '東埔', 7);

  [x, y]   = drawLin(ctx, mx, my, 100, 0, '20m');
  [xx, yy] = drawLoc(ctx, x, y, '雙龍', 1);
  [x, y]   = drawLin(ctx, x, y, 50, 0, '5k', true);
  [bx, by] = drawLoc(ctx, x, y, '黑黑谷', 1);

  [x, y]   = drawLin(ctx, ex, ey, (xx+bx)/2-ex, 0, '', true, 'green');
  [x, y]   = drawLoc(ctx, x, y, '郡大山', 7);
  [x, y]   = drawLin(ctx, x, y, 0, fy-y+10, '', true, 'green');
  [qx, qy] = drawLoc(ctx, x, y, '鞍', 5);
  [x, y]   = drawLin(ctx, x, y, 0, -25, '', true, 'green');
  [rx, ry] = drawLoc(ctx, x, y, '巒安堂', 5);
  [x, y]   = drawLin(ctx, x, y, 0, -25, '', true, 'green');
  [sx, sy] = drawLoc(ctx, x, y, '鞍', 5);
  [x, y]   = drawLin(ctx, x, y, (bx-x)/2, (by-y)/2, '', true, 'green');
  [x, y]   = drawLoc(ctx, x, y, '治茆山', 5);
  [x, y]   = drawLin(ctx, x, y, bx-x, by-y, '', true, 'green');
  [x, y]   = drawLin(ctx, sx, sy, xx-sx, yy-sy, '', true, 'green');

  [x, y]   = drawLin(ctx, qx, qy, -25, -10, '', true, 'green');
  [x, y]   = drawLoc(ctx, x, y, '金子山', 6);
  [x, y]   = drawLin(ctx, x, y, fx-x, fy-y, '', true, 'green');

  [x, y]   = drawLin(ctx, rx, ry, -25, -10, '', true, 'green');
  [x, y]   = drawLoc(ctx, x, y, '西巒大山', 3);
  [x, y]   = drawLin(ctx, x, y, nx-x, ny-y, '人倫林道', true, 'green');
</script>

<section id="lodge">
  <button class="sec-toggle" onclick="toggleSec(this)"></button>
  <h2>住宿</h2>
  <div class="sec-content">
    <div><span class="tag">D0 屏東</span>Airbun 屏東市中山一路58-3號 / Yi Usuan Chiu / 0905-132-101</div>
    <div><span class="tag">D10 知本森林遊樂區</span>觀海亭</div>
    <div><span class="tag">D10 知本</span>台東知本忠義堂 / 卑南鄉龍泉路38號 / 07:30~21:30</div>
  </div>
</section>

<section id="ref">
  <button class="sec-toggle" onclick="toggleSec(this)"></button>
  <h2>行程參考</h2>
  <div class="sec-content">
    <p>2017.02 <a href="https://www.keepon.com.tw/thread-d4472449-1af3-e611-80c7-901b0e54a4e6.html">蚯蚓．關門橫斷秘境之旅</a></p>
  </div>
</section>

</body>
</html>
